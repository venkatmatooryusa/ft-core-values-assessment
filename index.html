<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Forgotten Tracks – Core Values Assessment</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="header">
    <div class="brand">
      <div class="logo-dot"></div>
      <div>
        <h1>Forgotten Tracks</h1>
        <p class="subtitle">Core Values Assessment (40 Questions)</p>
      </div>
    </div>

    <div class="header-actions">
      <a class="btn btn-ghost" href="#about">About</a>
    </div>
  </header>

  <main class="container">
    <section class="card intro">
      <h2>Instructions</h2>
      <ul>
        <li>Answer honestly. There are no right or wrong answers.</li>
        <li>Likert questions: choose from <strong>Strongly Disagree</strong> to <strong>Strongly Agree</strong>.</li>
        <li>Forced-choice questions: pick the option that feels <strong>more like you</strong>.</li>
      </ul>

      <div class="grid2">
        <label class="field">
          <span>Student name (optional)</span>
          <input id="studentName" type="text" placeholder="e.g., Alex" autocomplete="name" />
        </label>

        <label class="field">
          <span>Grade (optional)</span>
          <select id="studentGrade">
            <option value="">Select</option>
            <option>9</option><option>10</option><option>11</option><option>12</option>
          </select>
        </label>
      </div>

      <div class="actions">
        <button id="startBtn" class="btn btn-primary" type="button">Start assessment</button>
        <button id="resumeBtn" class="btn btn-secondary" type="button">Resume saved attempt</button>
        <button id="resetBtn" class="btn btn-ghost" type="button">Reset</button>
      </div>

      <p class="hint">
        This runs fully in the browser (no server). If you refresh, your progress can be saved locally.
      </p>
    </section>

    <section id="assessment" class="card hidden">
      <div class="section-head">
        <h2>Assessment</h2>
        <div class="progress">
          <span id="progressText">0 / 40 answered</span>
          <div class="bar"><div id="progressBar" class="bar-fill"></div></div>
        </div>
      </div>

      <div class="tabs">
        <button id="tabLikert" class="tab active" type="button">Likert (24)</button>
        <button id="tabForced" class="tab" type="button">Forced-choice (16)</button>
      </div>

      <div id="likertContainer"></div>
      <div id="forcedContainer" class="hidden"></div>

      <div class="actions sticky">
        <button id="saveBtn" class="btn btn-secondary" type="button">Save</button>
        <button id="submitBtn" class="btn btn-primary" type="button">Generate results</button>
      </div>

      <p id="validationMsg" class="validation hidden"></p>
    </section>

    <section id="results" class="card hidden">
      <div class="section-head">
        <h2>Results</h2>
        <div class="actions">
          <button id="backBtn" class="btn btn-secondary" type="button">Back to questions</button>
          <button id="printBtn" class="btn btn-primary" type="button">Print (Counselor)</button>
          <button id="downloadJsonBtn" class="btn btn-secondary" type="button">Download JSON</button>
          <button id="downloadPngBtn" class="btn btn-secondary" type="button">Download Chart PNG</button>
          <button id="clearSavedBtn" class="btn btn-ghost" type="button">Clear saved attempt</button>
        </div>
      </div>

      <div class="grid2 results-grid">
        <div class="panel">
          <h3>Radar chart</h3>
          <canvas id="radarChart" width="420" height="420" aria-label="Radar chart"></canvas>
          <p class="hint">Scores shown on a 0–100 scale.</p>
        </div>

        <div class="panel">
          <h3>Top values</h3>
          <ol id="topValues" class="top-list"></ol>

          <div class="bands">
            <h4>Interpretation (rank-based)</h4>
            <p class="hint" id="rankNoteStudent">
              Bands are based on rank within the student:
              <strong>#1 Core Driver</strong> • <strong>#2 Strong</strong> • <strong>#3/#4 Supporting</strong> • <strong>#5/#6 Lower Pull</strong>.
            </p>
          </div>

          <div class="summary">
            <h4>Student summary</h4>
            <p id="summaryText"></p>
          </div>
        </div>
      </div>

      <hr class="print-sep" />

      <!-- Counselor print view: hidden on screen, printed only -->
      <section id="printView" class="print card-print hidden">
        <div class="print-header">
          <div>
            <h2 class="print-title">Forgotten Tracks – Core Values Results</h2>
            <div class="print-meta" id="printMeta"></div>
            <div class="print-small" id="rankNotePrint">
              Rank-based bands: <strong>#1 Core Driver</strong> • <strong>#2 Strong</strong> • <strong>#3–4 Supporting</strong> • <strong>#5–6 Lower Pull</strong>.
            </div>
          </div>
          <div class="print-badges">
            <span class="pill">Counselor Copy</span>
            <span class="pill" id="printDate"></span>
          </div>
        </div>

        <!-- Page 1 -->
        <div class="print-grid">
          <div class="print-chart">
            <h3>Radar chart (0–100)</h3>
            <canvas id="radarChartPrint" width="520" height="520"></canvas>
            <!-- JS injects/updates this PNG for reliable printing -->
            <img id="radarChartPrintImg" alt="Core values radar chart" />
            <div class="print-small">Note: scores are normalized for charting; interpretation is rank-based.</div>
          </div>

          <div class="print-summary">
            <h3>Counselor notes</h3>
            <div class="notes-box"></div>
            <div class="notes-box"></div>
          </div>
        </div>

        <!-- ✅ Page 2: heading + table must stay together -->
        <div id="scoresBlock">
          <h3 class="mt">Scores table</h3>
          <table class="print-table" id="scoresTablePrint">
            <thead>
              <tr>
                <th>Core Value</th>
                <th>Score (0–100)</th>
                <th>Band</th>
                <th>What it signals (short)</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>

          <h3 class="mt">Student summary</h3>
          <p id="summaryTextPrint" class="print-paragraph"></p>

          <div class="print-summary mt">
            <h3>Top values</h3>
            <ol id="topValuesPrint" class="top-list"></ol>

            <h3 class="mt">Counselor notes</h3>
            <div class="notes-box"></div>
            <div class="notes-box"></div>
          </div>
        </div>

        <div class="print-footer">
          <div><strong>Reminder:</strong> This reflects what energizes the student, not ability or performance.</div>
          <div class="muted">Forgotten Tracks • Core Values Assessment</div>
        </div>
      </section>
    </section>

    <section id="about" class="card">
      <h2>About the six core values</h2>
      <div class="value-grid">
        <div class="value"><h4>Clarity &amp; Synthesis</h4><p>Distilling complexity into clear, actionable understanding.</p></div>
        <div class="value"><h4>Protection &amp; Preservation</h4><p>Defending vulnerable systems, communities, or assets over time.</p></div>
        <div class="value"><h4>Equity &amp; Access</h4><p>Removing barriers so opportunities and knowledge are fairly shared.</p></div>
        <div class="value"><h4>Utility &amp; Efficiency</h4><p>Designing practical systems that work better, faster, and at scale.</p></div>
        <div class="value"><h4>Creation &amp; Innovation</h4><p>Inventing new ideas and building original solutions.</p></div>
        <div class="value"><h4>Aesthetics &amp; Experience</h4><p>Shaping how things look, feel, and resonate emotionally.</p></div>
      </div>
    </section>
  </main>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="./app.js"></script>
</body>
</html>
